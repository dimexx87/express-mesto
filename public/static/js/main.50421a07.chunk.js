(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{13:function(e,t,a){e.exports=a(20)},18:function(e,t,a){},19:function(e,t,a){},20:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(8),i=a.n(r),c=(a(18),a(12)),s=a(1),l=a(9),u=a.n(l),p=function(){return o.a.createElement("header",{className:"header"},o.a.createElement("img",{className:"header__logo",alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f Mesto.Russia",src:u.a}),o.a.createElement("div",{className:"header__line"}))},d=a(10),m=a(11),_=new(function(){function e(t){var a=t.url,n=t.headers,o=void 0===n?{}:n;Object(d.a)(this,e),this.url=a,this.headers=o}return Object(m.a)(e,[{key:"getInitialCards",value:function(){return fetch("".concat(this.url,"/cards"),{headers:this.headers}).then(this._handleResponse)}},{key:"_handleResponse",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}},{key:"getUserInfo",value:function(){return fetch("".concat(this.url,"/users/me"),{headers:this.headers}).then(this._handleResponse)}},{key:"setUserInfo",value:function(e,t){return fetch("".concat(this.url,"/users/me"),{method:"PATCH",headers:this.headers,body:JSON.stringify({name:e,about:t})}).then(this._handleResponse)}},{key:"setAvatar",value:function(e){return fetch("".concat(this.url,"/users/me/avatar"),{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:e})}).then(this._handleResponse)}},{key:"insertCard",value:function(e,t){return fetch("".concat(this.url,"/cards"),{method:"POST",headers:this.headers,body:JSON.stringify({name:e,link:t})}).then(this._handleResponse)}},{key:"changeLikeCardStatus",value:function(e,t){return fetch("".concat(this.url,"/cards/likes/").concat(e),{method:t?"DELETE":"PUT",headers:this.headers}).then(this._handleResponse)}},{key:"deleteCard",value:function(e){return fetch("".concat(this.url,"/cards/").concat(e),{method:"DELETE",headers:this.headers}).then(this._handleResponse)}}]),e}())({url:"https://mesto.nomoreparties.co/v1/cohort-14",headers:{authorization:"42ce0924-10a6-4b78-98b5-287f3f244b55","Content-Type":"application/json"}}),f=a(4),h=a(3),b=a(6),g=function(e){var t=e.isOpen,a=e.name,n=e.title,r=e.children,i=Object(b.a)(e,["isOpen","name","title","children"]),c="popup__btn-save ".concat(i.disabled?"popup__btn-save_disabled":"");return o.a.createElement("div",{className:t?"popup popup_type_".concat(a," popup_opened"):"popup popup_type_".concat(a)},o.a.createElement("form",{className:"popup__container popup__form_card",name:a,noValidate:!0,onSubmit:i.onSubmit},o.a.createElement("button",{onClick:i.onClose,type:"button",className:"popup__btn-close"}),o.a.createElement("div",{className:"popup__title"},n),o.a.createElement(o.a.Fragment,null,r),i.isLoading?o.a.createElement("button",{className:"popup__btn-save",id:"saveButtonProfile"},i.buttonTextIsLoading):o.a.createElement("button",{disabled:i.disabled,className:c},i.buttonText)))},E=o.a.createContext(),v={name:{required:function(e){return""===e},minLength:function(e){return e&&e.length<2},maxLength:function(e){return e&&e.length>20},containNumbers:function(e){return!/^[\u0430-\u044f\u0410-\u042f\u0451\u0401a-zA-Z\s]+$/.test(e)}},description:{required:function(e){return""===e},minLength:function(e){return e&&e.length<2},maxLength:function(e){return e&&e.length>200}}},k=function(e){var t=o.a.useContext(E),a=o.a.useState(""),r=Object(s.a)(a,2),i=r[0],c=r[1],l=o.a.useState(""),u=Object(s.a)(l,2),p=u[0],d=u[1],m=Object(n.useState)({name:{required:!0,minLength:!0,maxLength:!0,containNumbers:!0},description:{required:!0,minLength:!0,maxLength:!0}}),_=Object(s.a)(m,2),b=_[0],k=_[1];o.a.useEffect((function(){e.isOpen&&(c(t.name),d(t.about))}),[t,e.isOpen]);var O=Object(n.useCallback)((function(e){c(e.target.value)}),[]),C=Object(n.useCallback)((function(e){d(e.target.value)}),[]),N=Object(n.useCallback)((function(t){t.preventDefault(),e.onUpdateUser({name:i,about:p})}),[i,p,e]);Object(n.useEffect)((function(){var e=Object.keys(v.name).map((function(e){var t=v.name[e](i);return Object(h.a)({},e,t)})).reduce((function(e,t){return Object(f.a)(Object(f.a)({},e),t)}),{}),t=Object.keys(v.description).map((function(e){var t=v.description[e](p);return Object(h.a)({},e,t)})).reduce((function(e,t){return Object(f.a)(Object(f.a)({},e),t)}),{});k({name:e,description:t})}),[i,p,k]);var j=Object.values(b.name).some(Boolean),y=Object.values(b.description).some(Boolean),L=j||y;return o.a.createElement(g,{name:"editProfileForm",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",isLoading:e.isLoading,buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",buttonTextIsLoading:"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 ...",isOpen:e.isOpen,onClose:e.onClose,onSubmit:N,disabled:L},o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"popup__field popup__field_info_name"},o.a.createElement("input",{placeholder:"\u0418\u043c\u044f",className:"popup__text",type:"text",name:i,value:i,onChange:O}),b.name.required&&o.a.createElement("span",{className:"popup__input popup__input-error"},"\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0437\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u044c"),b.name.minLength&&o.a.createElement("span",{className:"popup__input popup__input-error"},"\u0414\u043e\u043b\u0436\u043d\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043c\u0438\u043d\u0438\u043c\u0443\u043c 2 \u0441\u0438\u043c\u0432\u043e\u043b\u0430"),b.name.maxLength&&o.a.createElement("span",{className:"popup__input popup__input-error"},"\u0414\u043e\u043b\u0436\u043d\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043c\u0430\u043a\u0441\u0438\u043c\u0443\u043c 20 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"),b.name.containNumbers&&o.a.createElement("span",{className:"popup__input popup__input-error"},"\u0414\u043e\u043b\u0436\u043d\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0431\u0443\u043a\u0432\u044b")),o.a.createElement("div",{className:"popup__field popup__field_info_other"},o.a.createElement("input",{placeholder:"\u0420\u043e\u0434 \u0437\u0430\u043d\u044f\u0442\u0438\u0439",className:"popup__text",type:"text",name:p,value:p,onChange:C}),b.description.required&&o.a.createElement("span",{className:"popup__input popup__input-error"},"\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0437\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u044c"),b.description.minLength&&o.a.createElement("span",{className:"popup__input popup__input-error"},"\u0414\u043e\u043b\u0436\u043d\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043c\u0438\u043d\u0438\u043c\u0443\u043c 2 \u0441\u0438\u043c\u0432\u043e\u043b\u0430"),b.description.maxLength&&o.a.createElement("span",{className:"popup__input popup__input-error"},"\u0414\u043e\u043b\u0436\u043d\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043c\u0430\u043a\u0441\u0438\u043c\u0443\u043c 200 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"))))},O=function(e){var t=o.a.useRef(""),a=Object(n.useCallback)((function(a){a.preventDefault(),e.onUpdateAvatar({avatar:t.current.value})}),[e]);return o.a.useEffect((function(){t.current.value=""}),[e.isOpen]),o.a.createElement(g,{isOpen:e.isOpen,onClose:e.onClose,onSubmit:a,name:"editAvatarForm",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",isLoading:e.isLoading,buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",buttonTextIsLoading:"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 ..."},o.a.createElement("div",{className:"popup__field popup__field_info_other"},o.a.createElement("input",{type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"popup__text",name:"link",id:"link",required:!0,ref:t}),o.a.createElement("span",{id:"link-error",className:"popup__input"})))},C=function(e){var t=o.a.useState(""),a=Object(s.a)(t,2),r=a[0],i=a[1],c=o.a.useState(""),l=Object(s.a)(c,2),u=l[0],p=l[1],d=Object(n.useCallback)((function(e){i(e.target.value)}),[]),m=Object(n.useCallback)((function(e){p(e.target.value)}),[]),_=Object(n.useCallback)((function(t){t.preventDefault(),e.onAddPlace({place:r,link:u})}),[r,u,e]);return o.a.useEffect((function(){i(""),p("")}),[e.isOpen]),o.a.createElement(g,{isOpen:e.isOpen,onClose:e.onClose,onSubmit:_,name:"addCardForm",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",isLoading:e.isLoading,buttonText:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",buttonTextIsLoading:"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 ..."},o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"popup__field popup__field_info_name"},o.a.createElement("input",{type:"text",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",className:"popup__text",minLength:"1",maxLength:"30",required:!0,name:r,value:r,onChange:d}),o.a.createElement("span",{id:"place-error",className:"popup__input"})),o.a.createElement("div",{className:"popup__field popup__field_info_other"},o.a.createElement("input",{type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"popup__text",required:!0,name:u,value:u,onChange:m}),o.a.createElement("span",{id:"link-error",className:"popup__input"}))))},N=function(e){var t=Object(n.useCallback)((function(t){t.preventDefault(),e.onDeleteCard(e.deletingCard)}),[e]);return o.a.createElement(g,{isOpen:e.isOpen,onClose:e.onClose,name:"deleteCardForm",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",onSubmit:t,isLoading:e.isLoading,buttonText:"\u0414\u0430",buttonTextIsLoading:"\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435 ..."})};var j=function(e){var t=o.a.useContext(E),a=e.ownerId===t._id,n="photo-grid__delete ".concat(a?"photo-grid__delete_visible":"photo-grid__delete_hidden"),r=e.like.some((function(e){return e._id===t._id})),i="photo-grid__like ".concat(r?"photo-grid__like_active":null),c="photo-grid__like-number ".concat(e.likes>0?"photo-grid__like-number_visible":"photo-grid__like-number_hidden");return o.a.createElement("figure",{className:"photo-grid__item"},o.a.createElement("img",{onClick:function(){return e.onCardClick(e)},src:e.src,alt:"\u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0434\u043e\u0441\u0442\u043e\u043f\u0440\u0438\u043c\u0435\u0447\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438",className:"photo-grid__image"}),o.a.createElement("h3",{className:"photo-grid__title"},e.name),o.a.createElement("div",{className:"photo-grid__likes"},o.a.createElement("button",{type:"button",className:i,onClick:function(){return e.onCardLike(e)}}),o.a.createElement("div",{className:c},e.likes)),o.a.createElement("button",{type:"button",className:n,onClick:function(){return e.onCardDelete(e)}}))},y=(a(19),function(){return o.a.createElement("div",{className:"spinner"})}),L=function(e){var t=e.cards,a=Object(b.a)(e,["cards"]),n=o.a.useContext(E);return o.a.createElement("main",{id:"abc",className:"content"},o.a.createElement("section",{className:"profile"},o.a.createElement("div",{className:"profile__info"},o.a.createElement("button",{onClick:a.onEditAvatar,className:"profile__avatar"},o.a.createElement("div",{className:"profile__overlay"},o.a.createElement("div",{className:"profile__avatar-edit"})),o.a.createElement("img",{alt:"owner face",className:"profile__photo",src:n.avatar})),o.a.createElement("div",{className:"profile__author"},o.a.createElement("div",{className:"profile__edit-line"},o.a.createElement("h1",{className:"profile__title"},n.name),o.a.createElement("button",{onClick:a.onEditProfile,type:"button",className:"profile__btn-edit"})),o.a.createElement("h2",{className:"profile__subtitle"},n.about))),o.a.createElement("button",{onClick:a.onAddPlace,type:"button",className:"profile__btn-add"})),o.a.createElement("section",{className:"photo-grid"},a.isStartLoading&&t?o.a.createElement(y,null):t.map((function(e){return o.a.createElement(j,Object.assign({},e,{onCardClick:a.onCardClick,onCardDelete:a.onCardDelete,onCardLike:a.onCardLike}))}))))},x=function(){return o.a.createElement("footer",{className:"footer"},o.a.createElement("p",{className:"footer__copyright"},"\xa9 2020 Mesto Russia"))},S=function(e){return o.a.createElement("div",{className:e.isOpen?"popup popup_type_".concat(e.name," popup_opened"):"popup popup_type_".concat(e.name)},o.a.createElement("form",{className:"popup__picture-container"},o.a.createElement("img",{alt:"tremendous screen",src:e.src,className:"popup__image"}),o.a.createElement("button",{onClick:e.onClose,type:"button",className:"popup__btn-close",id:"cardPictureForm"}),o.a.createElement("h3",{className:"popup__bottom-title",id:"pictureTitle"},e.name)))};var I=function(){var e=Object(n.useState)({}),t=Object(s.a)(e,2),a=t[0],r=t[1],i=Object(n.useState)([]),l=Object(s.a)(i,2),u=l[0],d=l[1],m=Object(n.useState)(!1),f=Object(s.a)(m,2),h=f[0],b=f[1],g=Object(n.useState)(!1),v=Object(s.a)(g,2),j=v[0],y=v[1],I=Object(n.useState)(""),T=Object(s.a)(I,2),P=T[0],w=T[1];Object(n.useEffect)((function(){y(!0),Promise.all([_.getUserInfo(),_.getInitialCards()]).then((function(e){var t=Object(s.a)(e,2),a=t[0],n=t[1];r(a);var o=n.map((function(e){return{key:e._id,cardId:e._id,ownerId:e.owner._id,likes:e.likes.length,like:e.likes,name:e.name,src:e.link}}));d(o)})).catch((function(e){console.log(e)})).finally((function(){y(!1)}))}),[]);var A=Object(n.useState)(!1),D=Object(s.a)(A,2),R=D[0],U=D[1],q=Object(n.useState)(!1),F=Object(s.a)(q,2),J=F[0],B=F[1],M=Object(n.useState)(!1),z=Object(s.a)(M,2),H=z[0],V=z[1],Z=Object(n.useState)(!1),$=Object(s.a)(Z,2),G=$[0],K=$[1],Q=Object(n.useState)(!1),W=Object(s.a)(Q,2),X=W[0],Y=W[1],ee=Object(n.useState)({}),te=Object(s.a)(ee,2),ae=te[0],ne=te[1],oe=function(){U(!1),B(!1),V(!1),K(!1),Y(!1),ne({})};return o.a.createElement(E.Provider,{value:a},o.a.createElement("div",{className:"page"},o.a.createElement(p,null),o.a.createElement(L,{cards:u,onEditAvatar:function(){B(!0)},onEditProfile:function(){U(!0)},onAddPlace:function(){V(!0)},onCardClick:function(e){K(!0),ne(e)},onCardDelete:function(e){w(e.cardId),Y(!0)},onCardLike:function(e){var t=e.cardId,n=e.like.some((function(e){return e._id===a._id}));_.changeLikeCardStatus(t,n).then((function(e){var a={key:e._id,cardId:e._id,ownerId:e.owner._id,likes:e.likes.length,like:e.likes,name:e.name,src:e.link};!function(e){var t=e.newCards.map((function(e){return{key:e.key,cardId:e.cardId,ownerId:e.ownerId,likes:e.likes,like:e.like,name:e.name,src:e.src}}));d(t)}({newCards:u.map((function(e){return e.cardId===t?a:e}))})})).catch((function(e){console.log(e)}))},isStartLoading:j}),o.a.createElement(k,{isOpen:R,onClose:oe,onUpdateUser:function(e){b(!0),_.setUserInfo(e.name,e.about).then((function(e){r(e),oe()})).catch((function(e){console.log(e)})).finally((function(){b(!1)}))},isLoading:h}),o.a.createElement(O,{isOpen:J,onClose:oe,onUpdateAvatar:function(e){b(!0),_.setAvatar(e.avatar).then((function(e){r(e),oe()})).catch((function(e){console.log(e)})).finally((function(){b(!1)}))},isLoading:h}),o.a.createElement(C,{isOpen:H,onClose:oe,onAddPlace:function(e){b(!0),_.insertCard(e.place,e.link).then((function(e){var t={key:e._id,cardId:e._id,ownerId:e.owner._id,likes:e.likes.length,like:e.likes,name:e.name,src:e.link};d([t].concat(Object(c.a)(u))),oe()})).catch((function(e){console.log(e)})).finally((function(){b(!1)}))},isLoading:h}),o.a.createElement(N,{isOpen:X,onClose:oe,isLoading:h,onDeleteCard:function(e){b(!0);var t=u.filter((function(t){return e!==t.cardId}));_.deleteCard(e).then((function(){d(t),oe()})).catch((function(e){console.log(e)})).finally((function(){b(!1)}))},deletingCard:P}),o.a.createElement(S,{isOpen:G,onClose:oe,name:ae.name,src:ae.src}),o.a.createElement(x,null)))};i.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(I,null)),document.getElementById("root"))},9:function(e,t,a){e.exports=a.p+"static/media/logo.855a8c98.svg"}},[[13,1,2]]]);
//# sourceMappingURL=main.50421a07.chunk.js.map