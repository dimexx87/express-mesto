(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{13:function(e,t,n){e.exports=n(20)},18:function(e,t,n){},19:function(e,t,n){},20:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(8),c=n.n(o),i=(n(18),n(12)),s=n(1),l=n(9),u=n.n(l),p=function(){return r.a.createElement("header",{className:"header"},r.a.createElement("img",{className:"header__logo",alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f Mesto.Russia",src:u.a}),r.a.createElement("div",{className:"header__line"}))},d=n(10),m=n(11),_=new(function(){function e(t){var n=t.url,a=t.headers,r=void 0===a?{}:a;Object(d.a)(this,e),this.url=n,this.headers=r}return Object(m.a)(e,[{key:"getInitialCards",value:function(){return fetch("".concat(this.url,"/cards"),{headers:this.headers}).then(this._handleResponse)}},{key:"_handleResponse",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}},{key:"getUserInfo",value:function(){return fetch("".concat(this.url,"/users/me"),{headers:this.headers}).then(this._handleResponse)}},{key:"setUserInfo",value:function(e,t){return fetch("".concat(this.url,"/users/me"),{method:"PATCH",headers:this.headers,body:JSON.stringify({name:e,about:t})}).then(this._handleResponse)}},{key:"setAvatar",value:function(e){return fetch("".concat(this.url,"/users/me/avatar"),{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:e})}).then(this._handleResponse)}},{key:"insertCard",value:function(e,t){return fetch("".concat(this.url,"/cards"),{method:"POST",headers:this.headers,body:JSON.stringify({name:e,link:t})}).then(this._handleResponse)}},{key:"changeLikeCardStatus",value:function(e,t){return fetch("".concat(this.url,"/cards/likes/").concat(e),{method:t?"DELETE":"PUT",headers:this.headers}).then(this._handleResponse)}},{key:"deleteCard",value:function(e){return fetch("".concat(this.url,"/cards/").concat(e),{method:"DELETE",headers:this.headers}).then(this._handleResponse)}}]),e}())({url:"https://mesto.nomoreparties.co/v1/cohort-14",headers:{authorization:"42ce0924-10a6-4b78-98b5-287f3f244b55","Content-Type":"application/json"}}),f=n(4),h=n(3),b=n(6),v=function(e){var t=e.isOpen,n=e.name,a=e.title,o=e.children,c=Object(b.a)(e,["isOpen","name","title","children"]),i="popup__btn-save ".concat(c.disabled?"popup__btn-save_disabled":"");return r.a.createElement("div",{className:t?"popup popup_type_".concat(n," popup_opened"):"popup popup_type_".concat(n)},r.a.createElement("form",{className:"popup__container popup__form_card",name:n,noValidate:!0,onSubmit:c.onSubmit},r.a.createElement("button",{onClick:c.onClose,type:"button",className:"popup__btn-close"}),r.a.createElement("div",{className:"popup__title"},a),r.a.createElement(r.a.Fragment,null,o),r.a.createElement("button",{disabled:c.disabled,className:i},c.buttonText)))},E=r.a.createContext(),g={name:{required:function(e){return""===e},minLength:function(e){return e&&e.length<2},maxLength:function(e){return e&&e.length>20},containNumbers:function(e){return!/^[\u0430-\u044f\u0410-\u042f\u0451\u0401a-zA-Z\s]+$/.test(e)}},description:{required:function(e){return""===e},minLength:function(e){return e&&e.length<2},maxLength:function(e){return e&&e.length>200}}},k=function(e){var t=r.a.useContext(E),n=r.a.useState(""),o=Object(s.a)(n,2),c=o[0],i=o[1],l=r.a.useState(""),u=Object(s.a)(l,2),p=u[0],d=u[1],m=Object(a.useState)({name:{required:!0,minLength:!0,maxLength:!0,containNumbers:!0},description:{required:!0,minLength:!0,maxLength:!0}}),_=Object(s.a)(m,2),b=_[0],k=_[1];r.a.useEffect((function(){e.isOpen&&(i(t.name),d(t.about))}),[t,e.isOpen]);var O=Object(a.useCallback)((function(e){i(e.target.value)}),[]),C=Object(a.useCallback)((function(e){d(e.target.value)}),[]),N=Object(a.useCallback)((function(t){t.preventDefault(),e.onUpdateUser({name:c,about:p})}),[c,p,e]);Object(a.useEffect)((function(){var e=Object.keys(g.name).map((function(e){var t=g.name[e](c);return Object(h.a)({},e,t)})).reduce((function(e,t){return Object(f.a)(Object(f.a)({},e),t)}),{}),t=Object.keys(g.description).map((function(e){var t=g.description[e](p);return Object(h.a)({},e,t)})).reduce((function(e,t){return Object(f.a)(Object(f.a)({},e),t)}),{});k({name:e,description:t})}),[c,p,k]);var j=Object.values(b.name).some(Boolean),y=Object.values(b.description).some(Boolean),L=j||y;return r.a.createElement(v,{name:"editProfileForm",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",isLoading:e.isLoading,buttonText:e.isLoading?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 ...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:e.isOpen,onClose:e.onClose,onSubmit:N,disabled:L},r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"popup__field popup__field_info_name"},r.a.createElement("input",{placeholder:"\u0418\u043c\u044f",className:"popup__text",type:"text",name:c,value:c,onChange:O}),b.name.required&&r.a.createElement("span",{className:"popup__input popup__input-error"},"\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0437\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u044c"),b.name.minLength&&r.a.createElement("span",{className:"popup__input popup__input-error"},"\u0414\u043e\u043b\u0436\u043d\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043c\u0438\u043d\u0438\u043c\u0443\u043c 2 \u0441\u0438\u043c\u0432\u043e\u043b\u0430"),b.name.maxLength&&r.a.createElement("span",{className:"popup__input popup__input-error"},"\u0414\u043e\u043b\u0436\u043d\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043c\u0430\u043a\u0441\u0438\u043c\u0443\u043c 20 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"),b.name.containNumbers&&r.a.createElement("span",{className:"popup__input popup__input-error"},"\u0414\u043e\u043b\u0436\u043d\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0431\u0443\u043a\u0432\u044b")),r.a.createElement("div",{className:"popup__field popup__field_info_other"},r.a.createElement("input",{placeholder:"\u0420\u043e\u0434 \u0437\u0430\u043d\u044f\u0442\u0438\u0439",className:"popup__text",type:"text",name:p,value:p,onChange:C}),b.description.required&&r.a.createElement("span",{className:"popup__input popup__input-error"},"\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0437\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u044c"),b.description.minLength&&r.a.createElement("span",{className:"popup__input popup__input-error"},"\u0414\u043e\u043b\u0436\u043d\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043c\u0438\u043d\u0438\u043c\u0443\u043c 2 \u0441\u0438\u043c\u0432\u043e\u043b\u0430"),b.description.maxLength&&r.a.createElement("span",{className:"popup__input popup__input-error"},"\u0414\u043e\u043b\u0436\u043d\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043c\u0430\u043a\u0441\u0438\u043c\u0443\u043c 200 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"))))},O=function(e){var t=r.a.useRef(""),n=Object(a.useCallback)((function(n){n.preventDefault(),e.onUpdateAvatar({avatar:t.current.value})}),[e]);return r.a.useEffect((function(){t.current.value=""}),[e.isOpen]),r.a.createElement(v,{isOpen:e.isOpen,onClose:e.onClose,onSubmit:n,name:"editAvatarForm",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",isLoading:e.isLoading,buttonText:e.isLoading?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435 ...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"},r.a.createElement("div",{className:"popup__field popup__field_info_other"},r.a.createElement("input",{type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"popup__text",name:"link",id:"link",required:!0,ref:t}),r.a.createElement("span",{id:"link-error",className:"popup__input"})))},C=function(e){var t=r.a.useState(""),n=Object(s.a)(t,2),o=n[0],c=n[1],i=r.a.useState(""),l=Object(s.a)(i,2),u=l[0],p=l[1],d=Object(a.useCallback)((function(e){c(e.target.value)}),[]),m=Object(a.useCallback)((function(e){p(e.target.value)}),[]),_=Object(a.useCallback)((function(t){t.preventDefault(),e.onAddPlace({place:o,link:u})}),[o,u,e]);return r.a.useEffect((function(){c(""),p("")}),[e.isOpen]),r.a.createElement(v,{isOpen:e.isOpen,onClose:e.onClose,onSubmit:_,name:"addCardForm",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",isLoading:e.isLoading,buttonText:e.isLoading?"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435...":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"},r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"popup__field popup__field_info_name"},r.a.createElement("input",{type:"text",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",className:"popup__text",minLength:"1",maxLength:"30",required:!0,name:o,value:o,onChange:d}),r.a.createElement("span",{id:"place-error",className:"popup__input"})),r.a.createElement("div",{className:"popup__field popup__field_info_other"},r.a.createElement("input",{type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"popup__text",required:!0,name:u,value:u,onChange:m}),r.a.createElement("span",{id:"link-error",className:"popup__input"}))))},N=function(e){var t=Object(a.useCallback)((function(t){t.preventDefault(),e.onDeleteCard(e.deletingCard)}),[e]);return r.a.createElement(v,{isOpen:e.isOpen,onClose:e.onClose,name:"deleteCardForm",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",onSubmit:t,isLoading:e.isLoading,buttonText:e.isLoading?"\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435 ...":"\u0414\u0430"})};var j=function(e){var t=r.a.useContext(E),n=e.ownerId===t._id,a="photo-grid__delete ".concat(n?"photo-grid__delete_visible":"photo-grid__delete_hidden"),o=e.like.some((function(e){return e._id===t._id})),c="photo-grid__like ".concat(o?"photo-grid__like_active":null),i="photo-grid__like-number ".concat(e.likes>0?"photo-grid__like-number_visible":"photo-grid__like-number_hidden");return r.a.createElement("figure",{className:"photo-grid__item"},r.a.createElement("img",{onClick:function(){return e.onCardClick(e)},src:e.src,alt:"\u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0434\u043e\u0441\u0442\u043e\u043f\u0440\u0438\u043c\u0435\u0447\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438",className:"photo-grid__image"}),r.a.createElement("h3",{className:"photo-grid__title"},e.name),r.a.createElement("div",{className:"photo-grid__likes"},r.a.createElement("button",{type:"button",className:c,onClick:function(){return e.onCardLike(e)}}),r.a.createElement("div",{className:i},e.likes)),r.a.createElement("button",{type:"button",className:a,onClick:function(){return e.onCardDelete(e)}}))},y=(n(19),function(){return r.a.createElement("div",{className:"spinner"})}),L=function(e){var t=e.cards,n=Object(b.a)(e,["cards"]),a=r.a.useContext(E);return r.a.createElement("main",{id:"abc",className:"content"},r.a.createElement("section",{className:"profile"},r.a.createElement("div",{className:"profile__info"},r.a.createElement("button",{onClick:n.onEditAvatar,className:"profile__avatar"},r.a.createElement("div",{className:"profile__overlay"},r.a.createElement("div",{className:"profile__avatar-edit"})),r.a.createElement("img",{alt:"owner face",className:"profile__photo",src:a.avatar})),r.a.createElement("div",{className:"profile__author"},r.a.createElement("div",{className:"profile__edit-line"},r.a.createElement("h1",{className:"profile__title"},a.name),r.a.createElement("button",{onClick:n.onEditProfile,type:"button",className:"profile__btn-edit"})),r.a.createElement("h2",{className:"profile__subtitle"},a.about))),r.a.createElement("button",{onClick:n.onAddPlace,type:"button",className:"profile__btn-add"})),r.a.createElement("section",{className:"photo-grid"},n.isStartLoading&&t?r.a.createElement(y,null):t.map((function(e){return r.a.createElement(j,Object.assign({},e,{onCardClick:n.onCardClick,onCardDelete:n.onCardDelete,onCardLike:n.onCardLike}))}))))},S=function(){return r.a.createElement("footer",{className:"footer"},r.a.createElement("p",{className:"footer__copyright"},"\xa9 2020 Mesto Russia"))},x=function(e){return r.a.createElement("div",{className:e.isOpen?"popup popup_type_".concat(e.name," popup_opened"):"popup popup_type_".concat(e.name)},r.a.createElement("form",{className:"popup__picture-container"},r.a.createElement("img",{alt:"tremendous screen",src:e.src,className:"popup__image"}),r.a.createElement("button",{onClick:e.onClose,type:"button",className:"popup__btn-close",id:"cardPictureForm"}),r.a.createElement("h3",{className:"popup__bottom-title",id:"pictureTitle"},e.name)))};var I=function(){var e=Object(a.useState)({}),t=Object(s.a)(e,2),n=t[0],o=t[1],c=Object(a.useState)([]),l=Object(s.a)(c,2),u=l[0],d=l[1],m=Object(a.useState)(!1),f=Object(s.a)(m,2),h=f[0],b=f[1],v=Object(a.useState)(!1),g=Object(s.a)(v,2),j=g[0],y=g[1],I=Object(a.useState)(""),w=Object(s.a)(I,2),P=w[0],A=w[1];Object(a.useEffect)((function(){var e=function(e){27===e.keyCode&&re()};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[]),Object(a.useEffect)((function(){var e=function(e){e.target===e.target.closest(".popup")&&re()};return document.addEventListener("click",e),function(){document.removeEventListener("click",e)}}),[]),Object(a.useEffect)((function(){y(!0),Promise.all([_.getUserInfo(),_.getInitialCards()]).then((function(e){var t=Object(s.a)(e,2),n=t[0],a=t[1];o(n);var r=a.map((function(e){return{key:e._id,cardId:e._id,ownerId:e.owner._id,likes:e.likes.length,like:e.likes,name:e.name,src:e.link}}));d(r)})).catch((function(e){return console.log("\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435 \u0438 \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438: ".concat(e))})).finally((function(){y(!1)}))}),[]);var T=Object(a.useState)(!1),D=Object(s.a)(T,2),R=D[0],U=D[1],q=Object(a.useState)(!1),F=Object(s.a)(q,2),J=F[0],B=F[1],M=Object(a.useState)(!1),z=Object(s.a)(M,2),H=z[0],V=z[1],Z=Object(a.useState)(!1),$=Object(s.a)(Z,2),G=$[0],K=$[1],Q=Object(a.useState)(!1),W=Object(s.a)(Q,2),X=W[0],Y=W[1],ee=Object(a.useState)({}),te=Object(s.a)(ee,2),ne=te[0],ae=te[1],re=function(){U(!1),B(!1),V(!1),K(!1),Y(!1),ae({})};return r.a.createElement(E.Provider,{value:n},r.a.createElement("div",{className:"page"},r.a.createElement(p,null),r.a.createElement(L,{cards:u,onEditAvatar:function(){B(!0)},onEditProfile:function(){U(!0)},onAddPlace:function(){V(!0)},onCardClick:function(e){K(!0),ae(e)},onCardDelete:function(e){A(e.cardId),Y(!0)},onCardLike:function(e){var t=e.cardId,a=e.like.some((function(e){return e._id===n._id}));_.changeLikeCardStatus(t,a).then((function(e){var n={key:e._id,cardId:e._id,ownerId:e.owner._id,likes:e.likes.length,like:e.likes,name:e.name,src:e.link};!function(e){var t=e.newCards.map((function(e){return{key:e.key,cardId:e.cardId,ownerId:e.ownerId,likes:e.likes,like:e.like,name:e.name,src:e.src}}));d(t)}({newCards:u.map((function(e){return e.cardId===t?n:e}))})})).catch((function(e){return console.log("\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0441\u0442\u0430\u0442\u0443\u0441\u0430 \u043b\u0430\u0439\u043a\u0430: ".concat(e))}))},isStartLoading:j}),r.a.createElement(k,{isOpen:R,onClose:re,onUpdateUser:function(e){b(!0),_.setUserInfo(e.name,e.about).then((function(e){o(e),re()})).catch((function(e){return console.log("\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435: ".concat(e))})).finally((function(){b(!1)}))},isLoading:h}),r.a.createElement(O,{isOpen:J,onClose:re,onUpdateAvatar:function(e){b(!0),_.setAvatar(e.avatar).then((function(e){o(e),re()})).catch((function(e){return console.log("\u041e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0430\u0432\u0430\u0442\u0430\u0440\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f: ".concat(e))})).finally((function(){b(!1)}))},isLoading:h}),r.a.createElement(C,{isOpen:H,onClose:re,onAddPlace:function(e){b(!0),_.insertCard(e.place,e.link).then((function(e){var t={key:e._id,cardId:e._id,ownerId:e.owner._id,likes:e.likes.length,like:e.likes,name:e.name,src:e.link};d([t].concat(Object(i.a)(u))),re()})).catch((function(e){return console.log("\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043d\u043e\u0432\u043e\u0439 \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438: ".concat(e))})).finally((function(){b(!1)}))},isLoading:h}),r.a.createElement(N,{isOpen:X,onClose:re,isLoading:h,onDeleteCard:function(e){b(!0);var t=u.filter((function(t){return e!==t.cardId}));_.deleteCard(e).then((function(){d(t),re()})).catch((function(e){return console.log("\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435 \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438: ".concat(e))})).finally((function(){b(!1)}))},deletingCard:P}),r.a.createElement(x,{isOpen:G,onClose:re,name:ne.name,src:ne.src}),r.a.createElement(S,null)))};c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(I,null)),document.getElementById("root"))},9:function(e,t,n){e.exports=n.p+"static/media/logo.855a8c98.svg"}},[[13,1,2]]]);
//# sourceMappingURL=main.32693506.chunk.js.map